################################################################################
# 오류 모니터링 설정 파일
################################################################################

# ============================================================================
# 기본 설정
# ============================================================================

# 모니터링할 로그 파일 경로
LOG_FILE="/var/log/app/error.log"

# 상세 로그 출력 여부 (true/false)
VERBOSE=true

# ============================================================================
# 알고리즘 파라미터
# ============================================================================

# 통계적 이상치 감지
# - 윈도우 크기: 비교할 과거 데이터 개수 (기본: 12 = 1시간, 5분 단위)
WINDOW_SIZE=12

# - 시그마 배수: 민감도 조절 (기본: 2.5)
#   2.0 = 매우 민감 (약 95% 신뢰구간)
#   2.5 = 표준 (약 98% 신뢰구간)
#   3.0 = 보수적 (약 99.7% 신뢰구간)
SIGMA_MULTIPLIER=2.5

# 변화율 감지
# - 임계값: 증가율 퍼센트 (기본: 100 = 2배 증가)
#   50  = 1.5배 증가시 알림
#   100 = 2배 증가시 알림
#   200 = 3배 증가시 알림
CHANGE_RATE_THRESHOLD=100

# EWMA (지수 가중 이동 평균) - 향후 사용
# - 평활 계수 (0.1 ~ 0.5)
EWMA_ALPHA=0.3

# ============================================================================
# 알림 설정
# ============================================================================

# 알림 쿨다운 시간 (초 단위)
# - 같은 수준의 알림 반복 방지 (기본: 3600 = 1시간)
ALERT_COOLDOWN=3600

# Slack Webhook URL (비어있으면 Slack 알림 비활성화)
SLACK_WEBHOOK_URL=""

# Email 알림 설정
EMAIL_ENABLED=false
EMAIL_TO="admin@example.com"
EMAIL_FROM="monitor@example.com"
SMTP_SERVER="smtp.example.com"
SMTP_PORT=587

# ============================================================================
# 오류 타입별 가중치 및 임계값
# ============================================================================

# 가중치 (높을수록 중요)
declare -A ERROR_WEIGHTS=(
    ["FATAL"]=10
    ["ERROR"]=5
    ["WARN"]=1
    ["DatabaseException"]=8
    ["SQLException"]=8
    ["PaymentFailed"]=9
    ["PaymentException"]=9
    ["AuthError"]=7
    ["AuthenticationFailed"]=7
    ["NullPointerException"]=3
    ["IOException"]=4
    ["TimeoutException"]=6
)

# 개별 임계값 (해당 타입이 이 값 이상이면 즉시 알림)
declare -A ERROR_THRESHOLDS=(
    ["FATAL"]=5
    ["DatabaseException"]=10
    ["PaymentFailed"]=3
    ["PaymentException"]=3
    ["AuthError"]=15
)

# ============================================================================
# 시간대별 베이스라인 (선택사항)
# ============================================================================

# 시간대별 베이스라인 사용 여부
USE_TIME_BASELINE=false

# 요일_시간대별 정상 범위 평균값
declare -A BASELINE_MEAN=(
    ["Mon_09"]=150
    ["Mon_10"]=200
    ["Mon_11"]=180
    ["Mon_14"]=160
    ["Mon_15"]=140
    ["Tue_09"]=140
    ["Wed_09"]=145
    ["Thu_09"]=150
    ["Fri_09"]=160
)

# 요일_시간대별 표준편차
declare -A BASELINE_STDDEV=(
    ["Mon_09"]=20
    ["Mon_10"]=25
    ["Mon_11"]=22
    ["Mon_14"]=18
    ["Mon_15"]=15
    ["Tue_09"]=18
    ["Wed_09"]=19
    ["Thu_09"]=20
    ["Fri_09"]=22
)

# ============================================================================
# 고급 설정
# ============================================================================

# 로그 파일 최대 크기 (MB)
MAX_LOG_SIZE=100

# 히스토리 데이터 보관 기간 (일)
HISTORY_RETENTION_DAYS=30

# 디버그 모드 (true/false)
DEBUG_MODE=false

# 드라이런 모드 (알림 전송 안함, 테스트용)
DRY_RUN=false
